<div class="container-fluid">

<!--HEADER-->
<div class="row center-content">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <h1>Room Booking</h1>
    </div><!--container-->
</div><!--//header && row-->

<!--ITEMS CONTAINER-->
<div class="row">
    <!--item-->
    <div ng-repeat="room in rooms"
         class="info-container col-lg-3 col-md-4 col-sm-6 col-xs-12">
        <div>
            <p>Room type: {{ room.room_type }}</p>
            <p>Room number: {{ room.number }}</p>
            <p ng-if="room.available==1">Available to order: Yes</p>
            <p ng-if="room.available==0">Available to order: No</p>
            <button type="button"
                    ng-class="{true: 'invisible'}[room.available==0]"
                    class="btn btn-default btn-block btn-book"
                    data-toggle="modal"
                    data-target="#book{{room.id}}">
                Book
            </button>

            <!--MODAL WINDOW WITH BOOKING FORM-->
            <div id="book{{room.id}}"
                 class="modal fade"
                 role="dialog">
                <div class="modal-dialog modal-md">
                    <!-- Modal content-->
                    <div class="modal-content book-modal">
                        <div class="modal-header">
                            <span>Room type: {{room.room_type}} room</span>
                            <button type="button"
                                    class="close"
                                    data-dismiss="modal">
                                &times;
                            </button>
                        </div><!--//modal header-->

                        <div class="modal-body">
                            <form method="post"
                                  class="form-horizontal"
                                  name="reservation_form">

                                <!--validation block-->
                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12"
                                     ng-show="reservation_form.start_date.$untouched &&
                                              reservation_form.end_date.$untouched">
                                    <div class="alert-request-error alert-warning"
                                         ng-show="reservation_form.start_date.$error.required ||
                                                  reservation_form.end_date.$error.required">
                                        Please, select time
                                    </div><!--//alert text block-->
                                </div><!--//validation block-->

                                <!--start date input-->
                                <div class="form-group col-lg-4 col-md-4 col-sm-5 col-xs-5">
                                    <div class='input-group date'>
                                        <label for="start_date"
                                               class="control-label"
                                                style="padding-left: 15px">
                                            From &nbsp;&nbsp;
                                        </label>
                                        <select name="start_date"
                                                id="start_date"
                                                ng-model="reserv_from"
                                                required>
                                        </select>
                                    </div><!--//input group-->
                                </div><!--//start date input-->

                                <!--end date input-->
                                <div class="form-group col-lg-4 col-lg-offset-1 col-md-4 col-sm-5 col-xs-5"
                                     id="end-date-container">
                                    <div class='input-group date'>
                                        <label for="end_date"
                                               class="control-label">
                                            To &nbsp;&nbsp;
                                        </label>
                                        <select name="end_date"
                                                id="end_date"
                                                ng-model="reserv_to"
                                                required>
                                        </select>
                                    </div><!--//input group-->
                                </div><!--//end date input-->

                                <!--comment input-->
                                <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12 comment-block">
                                    <label for="user_comment"
                                           class="control-label"
                                           style="padding-left: 15px">
                                        Comment
                                    </label>
                                    <!--validation block-->
                                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12"
                                         ng-show="reservation_form.user_comment.$untouched">
                                        <div class="alert-request-error alert-warning"
                                             ng-show="reservation_form.user_comment.$error.required">
                                            Please, specify your reservation details
                                        </div><!--//alert text block-->
                                    </div><!--//validation block-->
                                    <!--textarea-->
                                    <div class='input-group col-lg-12 col-md-12 col-sm-12 col-xs-12'
                                         style="padding-left: 15px">
                                        <textarea name="user_comment"
                                                  id="user_comment"
                                                  ng-model="comment"
                                                  rows="10"
                                                  class="form-control"
                                                  required></textarea>
                                    </div><!--//textarea-->
                                </div><!--//comment input-->

                                <!--display all comments-->
                                <div class="comments-container col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                    <h5>Previous comments about current room:</h5>
                                    <hr>
                                    <p  ng-repeat="item in comments"
                                        ng-if="room.id==item.room_id">
                                        <span class="glyphicon glyphicon-pencil"
                                              aria-hidden="true">
                                        </span>
                                        {{item.comment}}
                                    </p>
                                </div><!--//display all comments-->

                                <!--submit button-->
                                <div class="btn-container">
                                    <input id="submit-booking"
                                           name="submit"
                                           ng-click="makeReserv(reserv_from, reserv_to, comment, room.id)"
                                           ng-disabled="reservation_form.user_comment.$invalid ||
                                                        reservation_form.start_date.$invalid ||
                                                        reservation_form.end_date.$invalid"
                                           type="submit"
                                           value="Make reservation"
                                           data-dismiss="modal"
                                           class="btn btn-success btn-block">
                                </div><!--//submit button-->

                            </form>
                        </div><!--//modal-body-->
                    </div><!--//modal-content-->
                </div><!--//modal-dialog-->
            </div><!--modal window-->
        </div>
    </div><!--//item-->
</div><!--//items container-->

</div><!--//main container-fluid-->

<!--change time view in booking form-->
<script>
    for(var i = 0; i < 24; i++) {
        var s = i.toString();
        if(s.length == 1) {
            s = "0" + s;
        }
        document.getElementById("start_date").innerHTML += ("<option value='" + i + "'>" + s + " : 00</option>");
        document.getElementById("end_date").innerHTML += ("<option value='" + i + "'>" + s + " : 00</option>");
    }
</script>